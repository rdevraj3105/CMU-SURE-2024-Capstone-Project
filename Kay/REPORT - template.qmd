---
title: "Impact of Adult Health-Related Practices on Juvenile Health Outcomes"
author:
  - Brooke Benton
  - Rohan Devraj  
  - Jade Kay
  - Jessica Lambert 
date: "July 26, 2024" 
toc: true
format:  
  html:
    theme: cosmo
    html-math-method: katex
    self-contained: true
execute:
  echo: false
  warning: false
  message: false
editor: 
  markdown: 
    wrap: sentence
---

------------------------------------------------------------------------

## Introduction

The health behaviors of adults in a community can have a profound impact on their children’s health outcomes. Juvenile quality and length of life can be impacted by the behaviors of the adults around them, such as smoking, drinking, poor diet, and physical inactivity. More insight into the relationship between these variables can be used to identify intergenerational health impacts to provide early intervention and prevention of juvenile outcomes, as well as inform new policy and education. In this report, we analyze the impact of a variety of adult health behaviors on child mortality rate and low birthweight on a county level.

We decided to use low birthweight as a measure of juvenile outcomes due to the risk of future health complications and death. According to the original data source, “infants born with low birthweight have approximately 20 times greater chance of dying than those with normal birth weight” (County Health Rankings 2024). Moreover, infants who survive low birthweight at birth “may face adverse health outcomes such as decreased growth, lower IQ, impaired language development, and chronic conditions (e.g., obesity, diabetes, cardiovascular disease) during adulthood” (County Health Rankings 2024). We also chose to use the child mortality rate variable as a juvenile outcome- while childhood mortality is somewhat rare, mortality rates illustrate the most severe consequence of negative health behaviors and can point to the most significant behaviors that need to be addressed. 


## Data

The data utilized is from the County Health Rankings & Roadmaps sourced by the Population Health Institute at the University of Washington. This dataset includes health and socioeconomic data at county level across the United States from 2024. Our key juvenile health outcomes, child mortality rate and low birthweight, are measured as number of deaths among residents under age 20 per 100,000 population and percentage of live births less than 2,500 grams, respectively. For this report we focused primarily on the following adult health behaviors and environments. 

- Insufficient sleep: percentage of adults who report fewer than 7 hours of sleep on average
- Excessive drinking: percentage of adults reporting binge or heavy drinking
- Adult smoking: percentage of adults who are current smokers
- Food Insecurity: percentage of adults who lack adequate access to food
- Uninsured: percentage of adult population under age 65 without health insurance
- Sexually Transmitted Infections: number of newly diagnosed chlamydia cases per 100,000 population
- Physical Inactivity: percentage of adults reporting no leisure-time physical activity 
- Adult Obesity: percentage of the adult population that reports a body mass index greater than or equal to 30 kg/m2


## Exploratory Data Analysis & Cleaning

We performed some initial pre-processing and cleaning of the dataset before investigating the variables. The following scatterplots demonstrate the child mortality rate relationship between adult obesity, adult smoking, and excessive drinking. Excessive drinking seems to contribute to the least amount of child mortality. However, adult smoking and adult obesity are able to show an increase in percentage as it relates to an increase in child mortality. From this we can predict that adult obesity and adult smoking has the highest correlation towards child mortality. Moreover, adult smoking and child mortality have the highest correlation coefficient which is 0.58.

```{r}
#Child Mortality scatterplots
library(ggplot2)
library(tidyverse)
library(janitor)
library(scales)
library(cowplot)
library(patchwork)

Data<- read_csv("/Users/jessicalambert/Desktop/CMU Health/CMU Capstone Project/Data/analytic_data2024.csv")


na.omit(Data)
Updated_Data <- Data |> 
  clean_names() |> 
  slice(-1) |> 
  mutate(adult_smoking_raw_value=as.numeric(adult_smoking_raw_value),
         child_mortality_raw_value= as.numeric(child_mortality_raw_value), infant_mortality_raw_value= as.numeric(infant_mortality_raw_value)) |> 
  filter(!is.na(adult_smoking_raw_value), !is.na(child_mortality_raw_value)) |> 
  filter(county_clustered_yes_1_no_0 %in% c(0,1))

Updated_Data2 <- Updated_Data|> 
  clean_names() |> 
  slice(-1) |> 
  mutate(adult_obesity_raw_value=as.numeric(adult_obesity_raw_value),
         child_mortality_raw_value= as.numeric(child_mortality_raw_value)) |> 
  filter(!is.na(adult_obesity_raw_value), !is.na(child_mortality_raw_value))


Updated_Data3 <- Updated_Data2 |> 
  clean_names() |> 
  slice(-1) |> 
  mutate(excessive_drinking_raw_value=as.numeric(excessive_drinking_raw_value),
         child_mortality_raw_value= as.numeric(child_mortality_raw_value)) |> 
  filter(!is.na(excessive_drinking_raw_value), !is.na(child_mortality_raw_value))


obesity<- Updated_Data3 |> 
  ggplot(aes(x= adult_obesity_raw_value, y= child_mortality_raw_value))+
  geom_point(color="brown", alpha=.3)+
  geom_smooth(method= lm, color="black")+
  scale_x_continuous(labels=percent_format())+
  scale_y_continuous()+
  labs(x= "Adult Obesity", y= "Child Mortality")+
  theme(text= element_text(family="Helvetica", size=13, face="bold", color="#2A475E"),
        plot.title = element_text(
          family= "Helvetica",
          size=15, 
          face= "bold", 
          color= "#2A475E", 
          hjust=.5
        ))+
  theme(
    axis.ticks= element_blank(), 
    axis.line= element_line(colour="grey50"), 
    panel.grid= element_line(color="#B4AEA9"),
    panel.grid.minor = element_blank(), 
    panel.grid.major.x = element_blank(), 
    panel.grid.major.y = element_blank(), 
    panel.background = element_rect(fill="#FBF9F4", color= "#FBF9F4"), 
    plot.background = element_rect(fill="#FBF9F4", color= "#FBF9F4")
 )

smoking<- Updated_Data3 |> 
  ggplot(aes(x= adult_smoking_raw_value, y= child_mortality_raw_value))+
  geom_point(color="brown", alpha=.3)+
  geom_smooth(method= lm, color="black")+
  scale_x_continuous(labels=percent_format())+
  scale_y_continuous()+
  labs(x= "Adult Smoking", y= "Child Mortality")+
  theme(text= element_text(family="Helvetica", size=13, face="bold", color="#2A475E"),
        plot.title = element_text(
          family= "Helvetica",
          size=15, 
          face= "bold", 
          color= "#2A475E", 
          hjust=.5
        ))+
  theme(
    axis.ticks= element_blank(), 
    axis.line= element_line(colour="grey50"), 
    panel.grid= element_line(color="#B4AEA9"),
    panel.grid.minor = element_blank(), 
    panel.grid.major.x = element_blank(), 
    panel.grid.major.y = element_blank(), 
    panel.background = element_rect(fill="#FBF9F4", color= "#FBF9F4"), 
    plot.background = element_rect(fill="#FBF9F4", color= "#FBF9F4")
  )

drinking<- Updated_Data3 |> 
  ggplot(aes(x= excessive_drinking_raw_value, y= child_mortality_raw_value))+
  geom_point(color="brown", alpha=.3)+
  geom_smooth(method= lm, color="black")+
  scale_x_continuous(labels=percent_format())+
  scale_y_continuous()+
  labs(x= "Excessive Drinking", y= "Child Mortality")+
  theme(text= element_text(family="Helvetica", size= 13, face="bold", color="#2A475E"),
        plot.title = element_text(
          family= "Helvetica",
          size=15, 
          face= "bold", 
          color= "#2A475E", 
          hjust=.5
        ))+
  theme(
    axis.ticks= element_blank(), 
    axis.line= element_line(colour="grey50"), 
    panel.grid= element_line(color="#B4AEA9"),
    panel.grid.minor = element_blank(), 
    panel.grid.major.x = element_blank(), 
    panel.grid.major.y = element_blank(), 
    panel.background = element_rect(fill="#FBF9F4", color= "#FBF9F4"), 
    plot.background = element_rect(fill="#FBF9F4", color= "#FBF9F4")
  )

plot_grid(drinking+smoking+obesity)
```

The following scatterplots are a glimpse at the relationship between low birthweight and some adult health behaviors: adult smoking, insufficient sleep, adult obesity, and physical inactivity. All four scatterplots demonstrate a strong positive correlation. Of the scatterplots shown, insufficient sleep has the strongest relationship with low birthweight.   


```{r}
# low birthweight scatterplots

theme_set(theme_light())
healthdata <- read_csv("/Users/jessicalambert/Desktop/CMU Health/CMU Capstone Project/Data/analytic_data2024.csv") |> 
  slice(-1) |> 
  clean_names()

healthdata_subset <- healthdata |> 
  select(state_abbreviation, name,county_clustered_yes_1_no_0, release_year, adult_smoking_raw_value, adult_obesity_raw_value, 
         food_insecurity_raw_value, excessive_drinking_raw_value, child_mortality_raw_value,
         physical_inactivity_raw_value,insufficient_sleep_raw_value, low_birthweight_raw_value, 
        sexually_transmitted_infections_raw_value, uninsured_raw_value) |> 
  mutate(across(ends_with('raw_value'), as.numeric)) |> 
  filter(county_clustered_yes_1_no_0 %in% c(0,1)) |> 
  na.omit()

birthweight_plot <- function(var_name, var_label){
  plot <- healthdata_subset |>
    ggplot(aes(x= {{var_name}}, y=low_birthweight_raw_value))+
    geom_point(alpha =0.4, color = "brown")+
   #geom_point(size = 3, alpha = 0.3, color = "brown") + 
    geom_smooth(method = lm, color = "#2a475e") +
    #geom_density2d() +
    #coord_fixed() +
    #theme(legend.position = "bottom")+
    #geom_rug(alpha = 0.5, color = "#2a475e")+
    scale_x_continuous(labels=percent_format())+
    scale_y_continuous(labels=percent_format())+
  labs(x = paste("Proportion of ", var_label),
       y = "Proportion of low birthweight",
       title = paste0(var_label, " vs. Low Birthweight"))+
  theme(text = element_text(family = "Helvetica", size = 6, face = "bold", color = "#2a475e"),
        plot.title = element_text(
          family = "Helvetica", 
          size = 5,
          face = "bold",
          color = "#2a475e",
          hjust = 0.5
        ))+
  theme(
    axis.ticks = element_blank(),
    axis.line = element_line(colour = "grey50"),
    panel.grid = element_line(color = "#b4aea9"),
    #panel.grid.minor = element_blank(),
    #panel.grid.major.x = element_blank(),
    #panel.grid.major.y = element_blank(),
    panel.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    text = element_text(family = "Helvetica", size = 10, 
                        face = "bold", color = "#2a475e"),
    plot.title = element_text(
            family = "Helvetica", 
            size = 12,
            face = "bold",
            color = "#2a475e",
            hjust = 0.5))
  return(plot)
}


smoke_plot = birthweight_plot(adult_smoking_raw_value, "Adult Smoking")
drinking_plot = birthweight_plot(excessive_drinking_raw_value, "Adult Drinking")
obesity_plot = birthweight_plot(adult_obesity_raw_value, "Adult Obesity")
inactivity_plot = birthweight_plot(physical_inactivity_raw_value, "Physical Inactivity")
sleep_plot = birthweight_plot(insufficient_sleep_raw_value, "Insufficient Sleep")
food_plot = birthweight_plot(food_insecurity_raw_value, "Food insecurity")
sti_plot = birthweight_plot(sexually_transmitted_infections_raw_value, "Sexually Transmitted Infections")
uninsured_plot = birthweight_plot(uninsured_raw_value, "Uninsured Adults")


plot_grid(smoke_plot, sleep_plot, obesity_plot, inactivity_plot)




```


The below graph illustrates the percentage of low birthweight births by state, and is colored by the percentage of the county population reporting insufficient sleep. The red points represent counties with over 75% of the population reporting insufficient sleep. Generally, counties that have a higher percentage of low birthweight births also have a higher percentage of insufficient sleep across the population. The red points are primarily to the right side of the graph, indicating an association between low birthweight and insufficient sleep. 

```{r}
#insufficient sleep lollipop graph

healthdata_subset <- healthdata |> 
  select(state_abbreviation, name,county_clustered_yes_1_no_0, release_year, adult_smoking_raw_value, adult_obesity_raw_value, 
         food_insecurity_raw_value, excessive_drinking_raw_value, child_mortality_raw_value,
         physical_inactivity_raw_value,insufficient_sleep_raw_value, low_birthweight_raw_value, 
        sexually_transmitted_infections_raw_value, uninsured_raw_value) |> 
  mutate(across(ends_with('raw_value'), as.numeric)) |> 
  filter(county_clustered_yes_1_no_0 %in% c(0,1)) |> 
  na.omit()

healthdata_subset <- healthdata_subset |> 
  mutate(binary_child_mortality = as.factor(ifelse(child_mortality_raw_value >=62, "yes", "no")))


healthdata_subset <- healthdata_subset |> 
  mutate(binary_sleep = as.factor(ifelse(insufficient_sleep_raw_value >=0.37, "yes", "no")))

healthdata_subset <- healthdata_subset |> 
  mutate(binary_drinking = as.factor(ifelse(excessive_drinking_raw_value >=0.19, "yes", "no")))


healthdata_subset |> 
  mutate(state_abbreviation=factor(state_abbreviation), 
         state_abbreviation = fct_reorder(state_abbreviation, low_birthweight_raw_value)) |> 
  ggplot(aes(group=state_abbreviation)) +
  geom_segment(aes(x=state_abbreviation, xend=state_abbreviation, y=0, yend=low_birthweight_raw_value)) +
  geom_point(aes(x=state_abbreviation,y=low_birthweight_raw_value, fill = binary_sleep),size=1.5, 
             alpha=0.75, shape=21)+
  #scale_y_continuous(breaks=seq(0,600,50))+
  scale_y_continuous(labels=percent_format())+
  coord_flip()+
  theme(
    panel.grid.major = element_blank(),
    panel.border = element_blank(),
    legend.position = "bottom",
    plot.title = element_text(size = 10, hjust = 0.5, vjust = 0.5, face = "bold", 
                              margin = margin(b = 0.2, unit = "cm")),
    axis.ticks = element_blank(),
    #axis.line = element_line(colour = "grey50"),
    panel.grid = element_line(color = "#b4aea9"),
    panel.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    plot.background = element_rect(fill = "#fbf9f4", color = "#fbf9f4"),
    axis.text.x = element_text(face="bold", color = "black"),
    axis.text.y = element_text(face="bold", color="black", size = 5),
    axis.title.y = element_text(face = "bold", color = "darkred"),
    axis.title.x = element_text(face = "bold", color = "darkred",vjust = -0.85),
    legend.background =  element_rect(fill = "#fbf9f4", color = "#fbf9f4")
  ) +
  scale_fill_manual(values = c("yes"="red","no"="darkgrey"))+
  labs(
    x = "State",
    y = "Low Birthweight",
    fill = "Insufficient sleep in \u{2265} 75% of county population ",
  )

```


## Methods and Results

Describe your results.
This can include tables and plots showing your results, as well as text describing how your models worked and the appropriate interpretations of the relevant output.
(Note: Don’t just write out the textbook interpretations of all model coefficients! Instead, interpret the output that is relevant for your question of interest that is framed in the introduction)

## Discussion

In this report, we examined a multitude of adult health behaviors and their relationship to child mortality and low birthweight.

**Limitations** 

The dataset only included three variables specific to juvenile health, two of which we chose to focus on. Child mortality rate is a relatively rare event and will experience small changes, especially in small communities, which may be hard to detect. Counties with smaller populations may also experience a lot of relative change in mortality rates from year to year, often due to normal variation rather than the true underlying risk for child mortality. The dataset consisted of county level population data, rather than data on parent-to-child relationships. This limited the conclusions we could make from trends in the data. 

**Future Work**

Our work focuses on predicting juvenile health outcomes from adult health behaviors in the population. For future analysis of this topic, better results can persist if data can be found specifically on parent health behaviors and child outcomes. Also, looking at data by state can best help infer which areas need more focus. Furthermore, investigation should be done into why excessive drinking and child mortality have a strong negative correlation. This is an important area to focus on being that this emphasizes some of the limitations within the project. For example, factors such as gender may be influencing the results. 

Based on our research for future studies, using demographic, income, and gender can all be contributing variables as it pertains to the outcome of low birthweight and child mortality. Having variables categorized by age can contribute to a bigger significance towards variables used. Age can give a further look into which age group has the highest correlation towards the variables used. 

## Appendix


**(Feel free to remove this section when you submit)**

This a Quarto document.
To learn more about Quarto see <https://quarto.org>.
You can use the Render button to see what it looks like in HTML.

### Text formatting

Text can be bolded with **double asterisks** and italicized with *single asterisks*.
Monospace text, such as for short code snippets, uses `backticks`.
(Note these are different from quotation marks or apostrophes.) Links are written [like this](http://example.com/).

Bulleted lists can be written with asterisks:

-   Each item starts on a new line with an asterisk.
-   Items should start on the beginning of the line.
-   Leave blank lines after the end of the list so the list does not continue.

Mathematics can be written with LaTeX syntax using dollar signs.
For instance, using single dollar signs we can write inline math: $(-b \pm \sqrt{b^2 - 4ac})/2a$.

To write math in "display style", i.e. displayed on its own line centered on the page, we use double dollar signs: $$
x^2 + y^2 = 1
$$

### Code blocks

Code blocks are evaluated sequentially when you hit Render.
As the code runs, `R` prints out which block is running, so naming blocks is useful if you want to know which one takes a long time.
After the block name, you can specify [chunk options](https://yihui.org/knitr/options/).
For example, `echo` controls whether the code is printed in the document.
By default, output is printed in the document in monospace:

```{r, echo = FALSE}
head(mtcars)
```

Chunk options can also be written inside the code block, which is helpful for really long options, as we'll see soon.

```{r}
#| echo: false
head(mtcars)
```

### Figures

If a code block produces a plot or figure, this figure will automatically be inserted inline in the report.
That is, it will be inserted exactly where the code block is.

```{r}
#| fig-width: 5
#| fig-height: 3.5
#| fig-cap: "This is a caption. It should explain what's in the figure and what's interesting about it. For instance: There is a negative, strong linear correlation between miles per gallon and horsepower for US cars in the 1970s."

library(tidyverse)
mtcars |> 
  ggplot(aes(x = mpg, y = hp)) +
  geom_point() +
  labs(x = "Miles per gallon",
       y = "Horsepower")
```

Notice the use of `fig-width` and `fig-height` to control the figure's size (in inches).
These control the sizes given to `R` when it generates the plot, so `R` proportionally adjusts the font sizes to be large enough.

### Tables

Use the `knitr::kable()` function to print tables as HTML:

```{r}
mtcars |> 
  slice(1:5) |> 
  knitr::kable()
```

We can summarize model results with a table.
For instance, suppose we fit a linear regression model:

```{r}
#| echo: true
model1 <- lm(mpg ~ disp + hp + drat, data = mtcars)
```

It is *not* appropriate to simply print `summary(model1)` into the report.
If we want the reader to understand what models we have fit and what their results are, we should provide a nicely formatted table.
A simple option is to use the `tidy()` function from the `broom` package to get a data frame of the model fit, and simply report that as a table.

```{r }
#| results: "asis"
#| tbl-cap: "Predicting fuel economy using vehicle features."

library(broom)
model1 |> 
  tidy() |>
  knitr::kable(digits = 2,
               col.names = c("Term", "Estimate", "SE", "t", "p"))
```
